<mvc:View
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"
    xmlns:viz.data="sap.viz.ui5.data"
    controllerName="com.candentech.sowtracker.controller.Dashboard"
    xmlns:core="sap.ui.core"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:shapes="sap.gantt.simple.shapes"
    xmlns:config="sap.gantt.config"
    xmlns:axistime="sap.gantt.axistime"
    xmlns:simple="sap.gantt.simple"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:table="sap.ui.table"
    displayBlock="true"
    xmlns:f="sap.f"
    xmlns:cards="sap.f.cards"
>
    <FlexBox
        id="mainFlex"
        width="100%"
        justifyContent="Center"
    >
        <VBox
            id="leftSide"
            width="60%"
            justifyContent="Start"
            height="100%"
        >
            <FlexBox
                id="vizframes"
                height="auto"
                class="sapUiSmallMarginBottom"
                justifyContent="SpaceBetween"
            >
                <viz:VizFrame
                    id="barchartContainer"
                    vizType="column"
                    width="450px"
                    height="300px"
                    vizProperties="{
                        title:{ text:'Close to Expiry'},
                        dataLabel:{ visible:true, showTotal:true },
                        legend:{ visible:true },
                        plotArea:{ colorPalette:['#6C32A9','#BA066C','#5D36FF','#5B738B'] }}"
                    uiConfig="{applicationSet:'fiori'}"
                >
                    <viz:dataset>
                        <viz.data:FlattenedDataset
                            id="bardata"
                            data="{path:'docs>/filtered/EXP',sorter : {
                            path : 'Type',descending:true
                            }}"
                        >
                            <viz.data:dimensions>
                                <viz.data:DimensionDefinition
                                    id="bardimension"
                                    name="projectName"
                                    value="{docs>ProjectName}"
                                />
                                <viz.data:DimensionDefinition
                                    id="bardimension1"
                                    name="type"
                                    value="{docs>Type}"
                                />
                            </viz.data:dimensions>
                            <viz.data:measures>
                                <viz.data:MeasureDefinition
                                    id="barmeasure"
                                    name="data"
                                    value="{path:'docs>AgreementEndDate', formatter:'.formatter.calculateExpiryChart'}"
                                />
                            </viz.data:measures>
                        </viz.data:FlattenedDataset>
                    </viz:dataset>

                    <viz:feeds>
                        <viz.feeds:FeedItem
                            id='valueAxisFeed'
                            uid="valueAxis"
                            type="Measure"
                            values="data"
                        />
                        <viz.feeds:FeedItem
                            id='categoryAxisFeed'
                            uid="categoryAxis"
                            type="Dimension"
                            values="projectName"
                        />
                        <viz.feeds:FeedItem
                            id='colorFeed'
                            uid="color"
                            type="Dimension"
                            values="type"
                        />
                    </viz:feeds>
                </viz:VizFrame>

                <viz:VizFrame
                    id="chartContainer"
                    vizType="donut"
                    width="450px"
                    height="300px"
                    vizProperties="{
                        title:{text:''},
                        dataLabel:{visible:true,showTotal:true,numberFormatter:{formatString:'0'}},
                        legend:{visible:true},
                        plotArea:{ colorPalette:['#6C32A9','#BA066C'] }}"
                    uiConfig="{applicationSet:'fiori'}"
                    class="sapUiResponsiveMarginEnd"
                >
                    <viz:dataset>
                        <viz.data:FlattenedDataset
                            id="_IDGenFlattenedDataset1"
                            data="{docs>/status}"
                        >
                            <viz.data:dimensions>
                                <viz.data:DimensionDefinition
                                    id="_IDGenDimensionDefinition1"
                                    name="Project Name"
                                    value="{docs>name}"
                                />
                                <!-- i just want to figur out how it work -->
                                <!-- value="{producst>ProjectName}" -->
                            </viz.data:dimensions>
                            <viz.data:measures>
                                <viz.data:MeasureDefinition
                                    id="_IDGenMeasureDefinition1"
                                    name="Expires in"
                                    value="{path:'docs>length'}"
                                />
                            </viz.data:measures>
                        </viz.data:FlattenedDataset>
                    </viz:dataset>

                    <viz:feeds>
                        <viz.feeds:FeedItem
                            id='size'
                            uid="size"
                            type="Measure"
                            values="Expires in"
                        />
                        <viz.feeds:FeedItem
                            id='color'
                            uid="color"
                            type="Dimension"
                            values="Project Name"
                        />
                    </viz:feeds>
                </viz:VizFrame>
            </FlexBox>

            <!-- gantt chart -->

            <simple:GanttChartContainer id="ganttContainer">
                <simple:toolbar>
                    <simple:ContainerToolbar id="toolbar" />
                </simple:toolbar>

                <simple:GanttChartWithTable
                    id="ganttTableContainer"
                    shapeSelectionMode="Single"
                >
                    <simple:axisTimeStrategy>
                        <axistime:StepwiseZoomStrategy
                            id="sss"
                            zoomLevel="2"
                        >
                            <axistime:totalHorizon>
                                <config:TimeHorizon
                                    id="th"
                                    endTime="20261029000000"
                                    startTime="20221129000000"
                                />
                            </axistime:totalHorizon>
                            <axistime:visibleHorizon>
                                <config:TimeHorizon
                                    id="thv"
                                    startTime="20230101000000"
                                    endTime="20251029000000"
                                />
                            </axistime:visibleHorizon>
                        </axistime:StepwiseZoomStrategy>
                    </simple:axisTimeStrategy>
                    <simple:table>
                        <table:Table
                            id="mainTable"
                            rows="{path: 'docs>/agreements'}"
                            selectionBehavior="RowSelector"
                            selectionMode="Single"
                        >
                            <table:columns>
                                <table:Column id="col">
                                    <Text
                                        id="text"
                                        text="Clients and Projects"
                                    />
                                    <table:template>
                                        <Label
                                            id="label"
                                            text="{docs>CompanyName} {docs>ProjectName}"
                                        />
                                    </table:template>
                                </table:Column>
                            </table:columns>
                            <table:rowMode>
                                <rowmodes:Fixed
                                    id="RowControl"
                                    rowCount="7"
                                />
                            </table:rowMode>

                            <table:rowSettingsTemplate>
                                <simple:GanttRowSettings
                                    id="grs"
                                    rowId="{docs>SrNo}"
                                >
                                    <simple:shapes1>
                                        <shapes:Task
                                            id="task"
                                            time="{path: 'docs>AgreementStartDate', formatter: '.formatter.calculateDuration'}"
                                            endTime="{path: 'docs>AgreementEndDate', formatter: '.formatter.calculateDuration'}"
                                            type="Normal"
                                            color="{path: 'docs>Type', formatter: '.formatter.getShapeColor'}"
                                        />
                                    </simple:shapes1>
                                </simple:GanttRowSettings>
                            </table:rowSettingsTemplate>
                        </table:Table>
                    </simple:table>
                </simple:GanttChartWithTable>
            </simple:GanttChartContainer>
        </VBox>
        <VBox
            height="100%"
            id="abobo"
            width="auto"
        >
            <Panel
                id="panel"
                width="auto"
                height="300px"
                class="sapUiSmallMarginBegin"
            >
                <f:Card id="Experies">
                    <f:header>
                        <cards:Header
                            id="ipi"
                            title="Urgent Expiries"
                        />
                    </f:header>
                    <f:content>
                        <List
                            id="as"
                            items="{docs>/filtered/EXP}"
                        >
                            <items>
                                <ObjectListItem
                                    type="Navigation"
                                    id="list"
                                    title="{docs>ProjectName}"
                                    intro="{docs>CompanyName}"
                                    number="{path:'docs>AgreementEndDate', formatter:'.formatter.calculateExpiry'}"
                                    numberState="{path:'docs>AgreementEndDate', formatter:'.formatter.expiryColor'}"
                                >
                                    <firstStatus>
                                        <ObjectStatus
                                            id="doctypes"
                                            text="{docs>Type}"
                                        />
                                    </firstStatus>
                                </ObjectListItem>
                            </items>
                        </List>
                    </f:content>
                </f:Card>
            </Panel>

            <HBox id="innerProj">
                <GenericTile
                    press=".filterDocs"
                    id="_IDGenGenericTile1"
                    class="sapUiSmallMargin sapUiMarginDown"
                    frameType="OneByHalf"
                    header="Total Documents"
                >
                    <customData>
                        <core:CustomData key="All" />
                    </customData>
                    <TileContent id="_IDGenTileContent1">
                        <Title
                            id="_IDGenTitle1"
                            titleStyle="H2"
                            text="{docs>/length/All}"
                            class="sapUiMarginSmallStart sapThemeHighlight"
                        />
                    </TileContent>
                </GenericTile>
                <GenericTile
                    press=".filterDocs"
                    id="_IDGenGenericTile"
                    class="sapUiSmallMargin sapUiMarginDown"
                    frameType="OneByHalf"
                    header="SOW"
                >
                    <customData>
                        <core:CustomData key="SOW" />
                    </customData>
                    <TileContent id="_IDGenTileContent">
                        <Title
                            id="_IDGenTitle"
                            titleStyle="H2"
                            text="{docs>/length/SOW}"
                            class="sapUiMarginSmallStart sapThemeHighlight"
                        />
                    </TileContent>
                </GenericTile>
            </HBox>
            <HBox id="2nd">
                <GenericTile
                    press=".filterDocs"
                    id="_IDGenGenericTile2"
                    class="sapUiSmallMargin sapUiMarginDown"
                    frameType="OneByHalf"
                    header="MSA"
                >
                    <customData>
                        <core:CustomData key="MSA" />
                    </customData>
                    <TileContent id="_IDGenTileContent2">
                        <Title
                            id="_IDGenTitle2"
                            titleStyle="H2"
                            text="{docs>/length/MSA}"
                            class="sapUiMarginSmallStart sapThemeHighlight"
                        />
                    </TileContent>
                </GenericTile>
                <GenericTile
                    header="NDA"
                    press=".filterDocs"
                    id="_IDGenGenericTile4"
                    class="sapUiSmallMargin sapUiMarginDown"
                    frameType="OneByHalf"
                >
                    <customData>
                        <core:CustomData key="NDA" />
                    </customData>
                    <TileContent id="_IDGenTileContent4">
                        <Title
                            id="_IDGenTitle3"
                            titleStyle="H2"
                            text="{docs>/length/NDA}"
                            class="sapUiMarginSmallStart sapThemeHighlight"
                        />
                    </TileContent>
                </GenericTile>
            </HBox>
            <!-- <GenericTile
                id="NavTable"
                frameType="TwoByHalf"
                class="sapUiResponsiveMargin"
                press=".navTable"
            >
                <TileContent
                    id="navContent"
                    state="Loaded"
                >
                    <content>
                        <Title
                            id="sadasd"
                            text="GO TO TABLE"
                            class="sapUiMarginSmallStart sapThemeHighlight"
                        />
                    </content>
                </TileContent>
                <TileContent id="arrow">
                    <core:Icon
                        id="hell"
                        src="sap-icon://arrow-right"
                        class="sapUiMarginSmallStart sapThemeHighlight"
                    />
                </TileContent>
            </GenericTile> -->
        </VBox>
    </FlexBox>
</mvc:View>
